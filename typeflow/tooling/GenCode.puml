@startuml
skinparam class {
	BackgroundColor<<CommandLineInputEndpoint>> BurlyWood
	BackgroundColor<<CommandLineArgsInputEndpoint>> BurlyWood
	BackgroundColor<<AliyunHttpInputEndpoint>> BurlyWood
	BackgroundColor<<OutputEndpoint>> BurlyWood
	BackgroundColor<<PureFunction>> LightBlue
	BackgroundColor<<AlternativePath>> LightGrey
	BackgroundColor<<ErrorPath>> Crimson
}

class GenCodeScript <<CommandLineArgsInputEndpoint>>
class ReadFile <<OutputEndpoint>>
class PlantUML2Model <<PureFunction>>
class GenPureFunctions <<PureFunction>>
class GenJavaPureFunction <<PureFunction>>
class GenOutputEndpoints <<PureFunction>>
class GenJavaOutputEndpoint <<PureFunction>>
class GenCommandLineArgsInputEndpoints <<PureFunction>>
class GenCommandLineArgsInputEndpoint <<PureFunction>>
class GenCustomTypes <<PureFunction>>
class GenCustomType <<PureFunction>>
class DefinitionSorter <<PureFunction>>
class InputEndpointSorter <<PureFunction>>
class SaveCodes <<OutputEndpoint>>
class SaveToFile <<OutputEndpoint>>
class "Failure[Exception]" <<ErrorPath>>
class "LPFCTFailure::Failure[Exception]" <<ErrorPath>>
class LoadPureFunctionCodeTemplate <<OutputEndpoint>>
class LoadOutputEndpointCodeTemplate <<OutputEndpoint>>
interface CodeLang
CodeLang <|-- LANG_JAVA
CodeLang <|-- LANG_SCALA

modelFilePath::String --> "1" GenCodeScript
outputPath::String --> "2" GenCodeScript
lang::String --> "3" GenCodeScript
packageName::String --> "4" GenCodeScript
platform::String --> "5" GenCodeScript
codeUri::String --> "6" GenCodeScript
GenCodeScript "1" --> Path
GenCodeScript "2" --> LANG_JAVA
GenCodeScript "2" --> LANG_SCALA
GenCodeScript "3" --> outputPath::Path
GenCodeScript "4" --> PackageName

LANG_JAVA -> "1" GenPureFunctions
LANG_SCALA -> "1" GenPureFunctions
LANG_JAVA --> "1" LoadPureFunctionCodeTemplate
LANG_SCALA --> "1" LoadPureFunctionCodeTemplate
LANG_JAVA -> "1" GenOutputEndpoints
LANG_SCALA -> "1" GenOutputEndpoints
LANG_JAVA --> "1" LoadOutputEndpointCodeTemplate
LANG_SCALA --> "1" LoadOutputEndpointCodeTemplate
LoadPureFunctionCodeTemplate --> CodeTemplate
LoadPureFunctionCodeTemplate --> "LPFCTFailure::Failure[Exception]"
LoadOutputEndpointCodeTemplate --> "OE::CodeTemplate"
CodeTemplate --> "4" GenPureFunctions
"OE::CodeTemplate" --> "4" GenOutputEndpoints
Path --> ReadFile
ReadFile --> "Success[puml::String]"
ReadFile --> "Failure[Exception]"
"Success[puml::String]" --> PlantUML2Model
PlantUML2Model --> domain.Model
domain.Model --> DefinitionSorter
DefinitionSorter --> "1" "Vector[PureFunction]"
DefinitionSorter --> "2" "Vector[InputEndpoint]"
DefinitionSorter --> "3" "Vector[OutputEndpoint]"
DefinitionSorter --> "4" "Vector[CustomType]"
"Vector[InputEndpoint]" --> InputEndpointSorter
InputEndpointSorter --> "Vector[CommandLineArgsInputEndpoint]"
InputEndpointSorter --> "Vector[AliyunHttpInputEndpoint]"
"Vector[PureFunction]" --> "2" GenPureFunctions
"Vector[CustomType]" --> GenCustomTypes
GenCustomTypes --> "Vector[JavaCode]"
GenCustomTypes *-- GenCustomType
CustomType --> GenCustomType
GenCustomType --> JavaCode
PackageName --> "3" GenPureFunctions
PackageName --> "3" GenOutputEndpoints
GenPureFunctions --> "Vector[JavaCode]"
GenPureFunctions *-- GenJavaPureFunction
GPJFIN::PackageName --> "1" GenJavaPureFunction
PureFunction --> "2" GenJavaPureFunction
GPJFIN::CodeTemplate --> "3" GenJavaPureFunction
GenJavaPureFunction --> GPJFOUT::JavaCode
"Vector[OutputEndpoint]" --> "2" GenOutputEndpoints
GenOutputEndpoints --> "Vector[JavaCode]"
GenOutputEndpoints *-- GenJavaOutputEndpoint
GJOEIN::PackageName --> "1" GenJavaOutputEndpoint
OutputEndpoint --> "2" GenJavaOutputEndpoint
GJOEIN::CodeTemplate --> "3" GenJavaOutputEndpoint
GenJavaOutputEndpoint --> GJOE::JavaCode
"Vector[CommandLineArgsInputEndpoint]" --> GenCommandLineArgsInputEndpoints
GenCommandLineArgsInputEndpoints --> "Vector[ScalaCode]"
GenCommandLineArgsInputEndpoints *-- GenCommandLineArgsInputEndpoint
"Vector[ScalaCode]" --> "1" SaveCodes
"Vector[JavaCode]" --> "1" SaveCodes
outputPath::Path --> "2" SaveCodes
SaveCodes *-- SaveToFile
@enduml